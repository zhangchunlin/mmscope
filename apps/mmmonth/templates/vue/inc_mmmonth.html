{{include "vue/inc_mmpreview.html"}}
<script>
Vue.component('mm-month', {
    delimiters : ['{', '}'],
    props : ["id"],
    data : function(){
        this.update_list()
        return {
            list : [],
            full : false,
            more : false
        }
    },
    methods : {
        update_list:function(){
            var thisp = this
            $.ajax({
                type: "POST",
                url: "{{=url_for('mmmonth.views.MmMonth.api_mm')}}",
                data: {id:thisp.id,full:thisp.full},
                success: function (data) {
                    if (data.success) {
                        thisp.list = data.list
                        thisp.more = data.more
                    }
                }
            })
        },
        update_full_list:function(){
            console.log("update_full_list")
            this.full = true
            this.update_list()
        }
    },
    template: `
    <span>
        <component v-bind:is="'mm-preview-'+item.type" v-for="item in list" :id="item.id" :mimetype="item.mimetype" :filename="item.filename" :fullpath="item.fullpath" :can_show="item.can_show"></component> <i v-if="more" class="ivu-icon ivu-icon-more" @click="update_full_list" style="font-size: 64px;"></i>
    </span>
    `
})
</script>
